<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Journal de la Voile</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Outfit', sans-serif;
      background: url('photo_marin/fond_index.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #1a2b4c;
    }

    header {
      background: rgba(2, 62, 138, 0.85);
      color: white;
      padding: 1.5rem 0 1rem;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    header h1 { margin: 0.5rem 0; font-size: 2.2rem; }

    nav { margin: 1rem 0; }
    nav button {
      background-color: #0077b6;
      color: white;
      border: none;
      margin: 0 0.5rem;
      padding: 0.6rem 1.2rem;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s ease;
    }

    nav button:hover { background-color: #00b4d8; }

    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 2rem;
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
    }

    .section { margin-bottom: 2.5rem; }

    .section h2 {
      border-left: 5px solid #00b4d8;
      padding-left: 0.5rem;
      font-size: 1.6rem;
      margin-bottom: 1rem;
    }

    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .card img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
    }

    .card-content {
      flex: 1;
    }

    .card h3 {
      margin-top: 0;
      color: #0077b6;
    }

      footer {
      background: rgba(0, 0, 0, 0.7);
      color: #ccc;
      text-align: center;
      padding: 20px;
      font-size: 0.9em;
      margin-top: 40px;
    }

    @media screen and (max-width: 768px) {
      nav button {
        display: block;
        margin: 0.5rem auto;
      }
      .container {
        margin: 1rem;
        padding: 1rem;
      }
      .card {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Le Sillage</h1>
  <nav>
    <button onclick="location.href='futur.html'">üèÅ Prochaine Course</button>
    <button onclick="location.href='infos.html'">üåä Meteo</button>
    <button onclick="location.href='marin.html'">üß≠ Infos Marins</button>
    <button onclick="location.href='journal.html'">üì∞ Notre Journal</button>
  </nav>
  <p>Journal sur les courses de la voile</p>
</header>

<div class="container">
  <section class="section">
    <h2>üìÖ Prochaines courses</h2>
    <div id="courses-container"></div>
  </section>

  <section class="section">
    <h2>‚õµ Grands marins</h2>
    <div id="marins-container"></div>
  </section>
</div>

<footer>
  ¬© 2025 Le Sillage. Tous droits r√©serv√©s.
</footer>

<script>
  function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  // Convertit une date textuelle (ex: "3‚Äì9 juin") en objet Date approximatif
  function parseFrenchDate(text) {
    const mois = {
      "janvier": 0, "f√©vrier": 1, "mars": 2, "avril": 3, "mai": 4, "juin": 5,
      "juillet": 6, "ao√ªt": 7, "septembre": 8, "octobre": 9, "novembre": 10, "d√©cembre": 11
    };

    const now = new Date();
    const annee = now.getFullYear();
    const match = text.match(/(\d+).*?(janvier|f√©vrier|mars|avril|mai|juin|juillet|ao√ªt|septembre|octobre|novembre|d√©cembre)/i);
    if (match) {
      const jour = parseInt(match[1]);
      const moisIndex = mois[match[2].toLowerCase()];
      return new Date(annee, moisIndex, jour);
    }
    return new Date(9999, 0, 1); // fallback tr√®s loin
  }

  // Charger les marins
  fetch('marins.json')
    .then(res => res.json())
    .then(marins => {
      const marinsRandom = shuffle(marins).slice(0, 2);
      const container = document.getElementById('marins-container');
      marinsRandom.forEach(m => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <img src="${m.photo}" alt="${m.nom}">
          <div class="card-content">
            <h3>${m.nom}</h3>
            <p><strong>Projets :</strong> ${m.projets || "N/A"}</p>
            <p><strong>Courses :</strong> ${m.courses || m.faits || "N/A"}</p>
          </div>`;
        container.appendChild(div);
      });
    });

  // Charger les courses
  fetch('courses.json')
    .then(res => res.json())
    .then(courses => {
      const today = new Date();
      const sortedCourses = courses
        .map(c => ({ ...c, parsedDate: parseFrenchDate(c.date) }))
        .filter(c => c.parsedDate >= today)
        .sort((a, b) => a.parsedDate - b.parsedDate)
        .slice(0, 2);

      const container = document.getElementById('courses-container');
      sortedCourses.forEach(c => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <div class="card-content">
            <h3>${c.title}</h3>
            <p><strong>Date :</strong> ${c.date}</p>
            <p><strong>Bateau :</strong> ${c.boat}</p>
            <p>${c.desc}</p>
          </div>`;
        container.appendChild(div);
      });
    });
</script>

</body>
</html>
